parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"xcJv":[function(require,module,exports) {
"use strict";function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getColor=l,exports.default=exports.Position=void 0;var r="tile",s="value",n=90,o=16,h=7,a=n+o,u=function e(t,r){i(this,e),this.x=t,this.y=r};function l(e){switch(e){case 2:return"#a6b3cc";case 4:return"#565575";case 8:return"#ffe9aa";case 16:return"#ff8080";case 32:return"#95ffa4";case 64:return"#91ddff";case 128:return"#c991e1";case 256:return"#aaffe4";case 512:return"#cbe3e7";case 1024:return"#ff5458";case 2048:return"#65b2ff";default:return"#100e23"}}function p(e){return e*a+h}exports.Position=u;var c=function(){function e(t,r,s){i(this,e),this.position=t,this.prevPosition=null,this.value=r,this.mergedFrom=[],this.parent=s,this.html=this.createHTMLTile(this.parent),this.needsAnim=!1,this.draw=this.draw.bind(this),this.progress=this.progress.bind(this),this.post=this.post.bind(this),this.preMerge=this.preMerge.bind(this),this.drawMerge=this.drawMerge.bind(this),this.progressMerge=this.progressMerge.bind(this),this.postMerge=this.postMerge.bind(this),this.instantRender()}return t(e,[{key:"createHTMLTile",value:function(){var e=document.createElement("div");e.className=r;var t=document.createElement("p");return t.className=s,t.innerHTML=this.value,e.appendChild(t),this.parent.appendChild(e),e}},{key:"removeMerged",value:function(){for(var e=0;e<this.mergedFrom.length;e+=1)this.parent.removeChild(this.mergedFrom[e].html);this.mergedFrom=[]}},{key:"preMerge",value:function(){var e=this;if(0!==this.mergedFrom.length){this.mergedFrom.forEach(function(t){null===t.prevPosition?(t.prevPosition=t.position,t.position=new u(e.position.x,e.position.y)):t.position=new u(e.position.x,e.position.y)})}}},{key:"progressMerge",value:function(e){if(0===this.mergedFrom.length)return{};var t=this.mergedFrom[0],i=this.mergedFrom[1];return{tileProg:t.progress(e),otherProg:i.progress(e)}}},{key:"drawMerge",value:function(e){if(0!==this.mergedFrom.length){var t=this.mergedFrom[0],i=this.mergedFrom[1];t.draw(e.tileProg),i.draw(e.otherProg)}}},{key:"postMerge",value:function(){this.html.style.background=l(this.value),this.removeMerged(),this.needsAnim=!1}},{key:"draw",value:function(e){if(this.prevPosition){var t=p(this.prevPosition.x)+e.x,i=p(this.prevPosition.y)+e.y;this.html.style.top="".concat(i,"px"),this.html.style.left="".concat(t,"px")}}},{key:"progress",value:function(e){return this.prevPosition?{x:Math.round((this.position.x-this.prevPosition.x)*a*e),y:Math.round((this.position.y-this.prevPosition.y)*a*e)}:{x:0,y:0}}},{key:"post",value:function(){this.prevPosition=null,this.needsAnim=!1}},{key:"instantRender",value:function(){this.html.style.left="".concat(p(this.position.x),"px"),this.html.style.top="".concat(p(this.position.y),"px"),this.html.style.background=l(this.value)}},{key:"removeHTML",value:function(){this.parent.removeChild(this.html)}},{key:"setMergedFrom",value:function(e,t){this.mergedFrom.length>2||(this.mergedFrom.push(e),this.mergedFrom.push(t))}},{key:"clearMergedFrom",value:function(){this.mergedFrom=[]}},{key:"didMerge",value:function(){return this.mergedFrom.length>0}},{key:"requestAnimation",value:function(){this.needsAnim=!0}},{key:"needsAnimation",value:function(){return this.needsAnim}},{key:"updatePosition",value:function(e){this.prevPosition=this.position,this.position=e}}]),e}();exports.default=c;
},{}],"K8rx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.DIRECTION=void 0;var i=require("./tile");function t(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function e(i,t){for(var e=0;e<t.length;e++){var s=t[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(i,s.key,s)}}function s(i,t,s){return t&&e(i.prototype,t),s&&e(i,s),i}var n={UP:1,DOWN:2,LEFT:3,RIGHT:4};exports.DIRECTION=n;var r=function(){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;t(this,e),this.size=i,this.matrix=this.createMatrix()}return s(e,[{key:"createMatrix",value:function(){for(var i=new Array(this.size),t=0;t<this.size;t+=1)i[t]=new Array(this.size);for(var e=0;e<this.size;e+=1)for(var s=0;s<this.size;s+=1)i[e][s]=null;return i}},{key:"getTile",value:function(i){if(i<0||i>Math.pow(this.size,2)-1)return"";for(var t=i,e=0;t>=4;)t-=this.size,e+=1;var s=this.matrix[t][e];return s||null}},{key:"insertTile",value:function(i){this.matrix[i.position.x][i.position.y]=i}},{key:"swapTiles",value:function(i,t){var e=this.matrix[t.x][t.y];this.matrix[t.x][t.y]=this.matrix[i.x][i.y],this.matrix[i.x][i.y]=e}},{key:"removeTile",value:function(i,t){this.matrix[i][t]=null}},{key:"eachTile",value:function(i){for(var t=0;t<this.size;t+=1)for(var e=0;e<this.size;e+=1)i(t,e,this.matrix[t][e])}},{key:"moveTile",value:function(t,e){var s=t.position;this.matrix[e.x][e.y]=this.matrix[s.x][s.y],this.removeTile(s.x,s.y),t.requestAnimation(),t.updatePosition(new i.Position(e.x,e.y))}},{key:"eachRow",value:function(i){for(var t=this.getRows(),e=0;e<t.length;e+=1)i(t[e])}},{key:"eachColumn",value:function(i){for(var t=this.getColumns(),e=0;e<t.length;e+=1)i(t[e])}},{key:"getRows",value:function(){for(var i=[],t=0;t<this.size;t+=1){for(var e=[],s=0;s<this.size;s+=1)e.push(this.matrix[s][t]);i.push(e)}return i}},{key:"getColumns",value:function(){for(var i=[],t=0;t<this.size;t+=1){for(var e=[],s=0;s<this.size;s+=1)e.push(this.matrix[t][s]);i.push(e)}return i}},{key:"isFull",value:function(){return 0===this.unusedTiles().length}},{key:"getRandomUnusedTile",value:function(){var i=this.unusedTiles();return i[Math.floor(Math.random()*i.length)]}},{key:"unusedTiles",value:function(){var t=[];return this.eachTile(function(e,s,n){n||t.push(new i.Position(e,s))}),t}},{key:"getAdjacentTiles",value:function(i){var t=[],e=null;return i.position.x>0&&(e=this.matrix[i.position.x-1][i.position.y])&&t.push(e),i.position.x<this.size-1&&(e=this.matrix[i.position.x+1][i.position.y])&&t.push(e),i.position.y>0&&(e=this.matrix[i.position.x][i.position.y-1])&&t.push(e),i.position.y<this.size-1&&(e=this.matrix[i.position.x][i.position.y+1])&&t.push(e),t}}]),e}();exports.default=r;
},{"./tile":"xcJv"}],"+7b7":[function(require,module,exports) {
"use strict";function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function r(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n="score-display",o="tile-area",i="score",a=.8,u="menu";function c(e){var r=e.pre,t=void 0===r?function(){return 0}:r,n=e.progress,o=void 0===n?function(){return 0}:n,i=e.draw,a=void 0===i?function(){return 0}:i,u=e.post,c=void 0===u?function(){return 0}:u,s=e.duration,d=performance.now();t(),requestAnimationFrame(function e(r){var t=(r-d)/s;t>1&&(t=1);var n=o(t);a(n),1===t&&c(),t<1&&requestAnimationFrame(e)})}var s=function(){function r(t){e(this,r),this.grid=t,this.scoreDisplay=document.querySelector("#".concat(n)),this.tileArea=document.querySelector(".".concat(o))}return t(r,[{key:"renderScore",value:function(e){this.scoreDisplay.querySelector("#".concat(i)).innerHTML=e}},{key:"render",value:function(){for(var e=0;e<Math.pow(this.grid.size,2);e+=1){var r=this.grid.getTile(e);r&&r.needsAnimation&&(r.didMerge()?c({pre:r.preMerge,progress:r.progressMerge,draw:r.drawMerge,post:r.postMerge,duration:150}):c({progress:r.progress,draw:r.draw,post:r.post,duration:150}))}}},{key:"renderMenu",value:function(e){var r=document.createElement("div");r.className=u,r.appendChild(e),this.tileArea.appendChild(r)}},{key:"removeMenus",value:function(){this.tileArea.querySelectorAll(".".concat(u)).forEach(function(e){c({post:function(){e.remove()},progress:function(e){return a-e<0?0:(a-e).toFixed(2)},draw:function(r){e.style.opacity=r},duration:200})})}}]),r}();exports.default=s;
},{}],"53mo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.EVENTS=void 0;var e=require("./grid");function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}var s={MOVE:"move",RESTART:"restart"};exports.EVENTS=s;var a=function(){function n(){var e=this;t(this,n),this.events={},this.onEvent=this.onEvent.bind(this),document.addEventListener("keydown",function(t){return e.onEvent(t,e.events)})}return r(n,[{key:"on",value:function(e,t){this.events[e]=t}},{key:"onEvent",value:function(t){switch(t.key){case"ArrowUp":case"w":this.events[s.MOVE](e.DIRECTION.UP);break;case"ArrowDown":case"s":this.events[s.MOVE](e.DIRECTION.DOWN);break;case"ArrowRight":case"d":this.events[s.MOVE](e.DIRECTION.RIGHT);break;case"ArrowLeft":case"a":this.events[s.MOVE](e.DIRECTION.LEFT);break;case"r":this.events[s.RESTART]()}}}]),n}();exports.default=a;
},{"./grid":"K8rx"}],"5JsG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("./grid")),t=o(require("./tile")),i=n(require("./renderer")),r=o(require("./input-manager"));function n(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,i):{};r.get||r.set?Object.defineProperty(t,i,r):t[i]=e[i]}return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),e}var l={INPROGRESS:2,INMENU:3},d={LOST:0,WON:1,NEUTRAL:2},h={LOSE:"Game Over!",PLAY_AGAIN:"Play again?"},c="menu-text",v="menu-button",f="restart-button",m=function(){function n(t){a(this,n),this.score=0,this.grid=new e.default(t),this.state=l.INMENU,this.gameState=d.NEUTRAL,this.inputManager=new r.default,this.renderer=new i.default(this.grid),this.gameAreaHTML=document.querySelector("div.tile-area"),this.addRandomTile=this.addRandomTile.bind(this),this.onRestart=this.onRestart.bind(this),this.onMove=this.onMove.bind(this),this.inputManager.on(r.EVENTS.MOVE,this.onMove),this.inputManager.on(r.EVENTS.RESTART,this.onRestart),document.querySelector("#".concat(f)).addEventListener("click",this.onRestart),this.startGame()}return u(n,[{key:"onMove",value:function(t){if(this.state!==l.INMENU){var i=!1;switch(t){case e.DIRECTION.UP:i=this.moveUp();break;case e.DIRECTION.DOWN:i=this.moveDown();break;case e.DIRECTION.LEFT:i=this.moveLeft();break;case e.DIRECTION.RIGHT:i=this.moveRight()}this.renderer.render(),i&&setTimeout(this.addRandomTile,100)}}},{key:"moveUp",value:function(){var e=this,i=!1;return this.grid.eachColumn(function(r){if(r)for(var n=0,o=null,a=0;a<e.grid.size;a+=1)if(r[a]){var s=r[a];o&&o.value===s.value?(e.merge(o,s),i=!0,o=null):(o=s,s.position.y!==n&&(i=!0,e.grid.moveTile(s,new t.Position(s.position.x,n))),n+=1)}}),i}},{key:"moveDown",value:function(){var e=this,i=!1;return this.grid.eachColumn(function(r){if(r)for(var n=e.grid.size-1,o=null,a=e.grid.size-1;a>=0;a-=1)if(r[a]){var s=r[a];o&&o.value===s.value?(e.merge(o,s),i=!0,o=null):(o=s,s.position.y!==n&&(i=!0,e.grid.moveTile(s,new t.Position(s.position.x,n))),n-=1)}}),i}},{key:"moveLeft",value:function(){var e=this,i=!1;return this.grid.eachRow(function(r){if(r)for(var n=0,o=null,a=0;a<e.grid.size;a+=1)if(r[a]){var s=r[a];o&&o.value===s.value?(e.merge(o,s),i=!0,o=null):(o=s,s.position.x!==n&&(i=!0,e.grid.moveTile(s,new t.Position(n,s.position.y))),n+=1)}}),i}},{key:"moveRight",value:function(){var e=this,i=!1;return this.grid.eachRow(function(r){if(r)for(var n=e.grid.size-1,o=null,a=e.grid.size-1;a>=0;a-=1)if(r[a]){var s=r[a];o&&o.value===s.value?(e.merge(o,s),i=!0,o=null):(o=s,s.position.x!==n&&(i=!0,e.grid.moveTile(s,new t.Position(n,s.position.y))),n-=1)}}),i}},{key:"merge",value:function(e,i){var r=2*e.value;2048===r&&(this.gameState=d.WON),this.score+=r,this.grid.removeTile(e.position.x,e.position.y),this.grid.removeTile(i.position.x,i.position.y);var n=new t.default(e.position,r,this.gameAreaHTML);n.setMergedFrom(e,i),n.requestAnimation(),this.grid.insertTile(n),this.renderer.renderScore(this.score)}},{key:"onRestart",value:function(){var e=this;this.renderer.removeMenus(),this.grid.eachTile(function(t,i,r){r&&(r.removeHTML(),e.grid.removeTile(t,i))}),this.startGame()}},{key:"startGame",value:function(){this.gameState=d.NEUTRAL,this.state=l.INPROGRESS,this.score=0,this.renderer.renderScore(this.score),this.addRandomTile(),this.addRandomTile()}},{key:"addRandomTile",value:function(){if(!this.grid.isFull()){var e=Math.random()<.9?2:4,i=new t.default(this.grid.getRandomUnusedTile(),e,this.gameAreaHTML);this.grid.insertTile(i),this.checkMovement()}}},{key:"checkMovement",value:function(){var e=this;if(this.grid.isFull()){var t=!0;this.grid.eachTile(function(i,r,n){if(t)for(var o=e.grid.getAdjacentTiles(n),a=0;a<o.length;a+=1)if(o[a].value===n.value){t=!1;break}}),t&&this.renderLose()}}},{key:"continueGame",value:function(){this.renderer.removeMenus(),this.state=l.NEUTRAL}},{key:"renderLose",value:function(){this.gameState=d.LOST,this.state=l.INMENU;var e=document.createElement("div");e.style.display="flex",e.style.flexDirection="column",e.style.justifyContent="center";var t=document.createElement("p");t.className=c,t.innerHTML=h.LOSE;var i=document.createElement("button");i.className=v,i.innerHTML=h.PLAY_AGAIN,i.addEventListener("click",this.onRestart),e.appendChild(t),e.appendChild(i),this.renderer.renderMenu(e)}}]),n}();exports.default=m;
},{"./grid":"K8rx","./tile":"xcJv","./renderer":"+7b7","./input-manager":"53mo"}],"A2T1":[function(require,module,exports) {
"use strict";var e=r(require("./game-manager"));function r(e){return e&&e.__esModule?e:{default:e}}(0,e.default)(4);
},{"./game-manager":"5JsG"}]},{},["A2T1"], null)
//# sourceMappingURL=/app.map